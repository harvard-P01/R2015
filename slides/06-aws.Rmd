---
title: "Data Science with R"
subtitle: "Lecture 06: Running R on AWS"
author: "Christine Choirat, cchoirat@gmail.com"
date: "March 28, 2016"
output: ioslides_presentation
---

## Objective

Analyze the airline on-time performance dataset on an Amazon instance

1. Sign-up for an account
2. Set up a machine
3. Install R, Rstudio, ...
4. Upload the data
5. Run a basic logit model

## Sign-up for a Free Tier account: https://aws.amazon.com/free/

- Many Free Tier products.

- Amazon EC2 "Amazon Elastic Compute Cloud"
    - "Resizable compute capacity in the Cloud."
    - 750 hours per month.  Expires 12 months after sign-up.
 
- Amazon S3
    - "Highly scalable, reliable, and low-latency data storage infrastructure."
    - 5 GB of Standard Storage
    
##  Array of system images (AMIs)

- Amazon Linux
- Red Hat Enterprise Linux
- SUSE Linux Enterprise Server
- Ubuntu Server 14.04 LTS
- Microsoft Windows Server
- ...

## Ports

- SSH
- HTTP
- HTTPS
- Custom HTTP 8787 for Rstudio server

## SSH and key pairing

In a terminal:

```{r eval=FALSE}
chmod 600 Downloads/rstudio.pem
ssh -i Downloads/rstudio.pem ubuntu@ec2-54-175-200-1.compute-1.amazonaws.com
```

```{r eval=FALSE}
sudo apt-get update
sudo apt-get install r-base
```

## Installing Rstudio

```{r eval=FALSE}
sudo apt-get install gdebi-core
wget https://download2.rstudio.org/rstudio-server-0.99.893-amd64.deb
sudo gdebi rstudio-server-0.99.893-amd64.deb
```

then add a user:

```{r eval=FALSE}
sudo adduser rstudio
```

## Using a user-contributed AMI

- http://www.louisaslett.com/RStudio_AMI/
- Ubuntu with R, Rstudio, STAN, ...
- Dropbox integration

## Importing data

```{r eval=FALSE}
library("RStudioAMI")
linkDropbox()
excludeSyncDropbox("*")
includeSyncDropbox("Dropbox/DataAWS/")
```

## Running a model

```{r eval=FALSE}
flights <- read.csv("Dropbox/DataAWS/allyears2k.csv")
names(flights)
glm(IsArrDelayed ~ Distance, data = flights, family = binomial("logit"))
```

## More detailed workflow

- https://blogs.aws.amazon.com/bigdata/post/Tx3IJSB6BMHWZE5/Running-R-on-AWS
- In particular S3 integration

