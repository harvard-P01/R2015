---
title: "Data Science with R"
subtitle: "Lecture 04: Illustration"
author: "Christine Choirat, cchoirat@gmail.com"
date: "November 09, 2015"
output: ioslides_presentation
---

## Statistical learning

<div class="centered">
<img src="04_illustration/ISL.jpg" width="200px"/>
</div>

- http://www-bcf.usc.edu/~gareth/ISL/
- http://www.dataschool.io/15-hours-of-expert-machine-learning-videos/

## Labs (12:30-1:30pm)

- 11/19 – FXB G11
- 12/7 – FXB G10
- 12/14 – FXB G10

# Retrieving data

## URL's

http://aqsdr1.epa.gov/aqsweb/aqstmp/airdata/download_files.html

<iframe src="http://aqsdr1.epa.gov/aqsweb/aqstmp/airdata/download_files.html"></iframe>

## URL's

```{r eval=FALSE}
f <- "http://aqsdr1.epa.gov/aqsweb/aqstmp/airdata/annual_all_2015.zip"
tmp <- tempfile()
download.file(f, tmp)
unzip(tmp, "annual_all_2015.csv")
```

```{r warning = FALSE}
library(data.table)
dat <- fread("annual_all_2015.csv")
dat
```

## URL's

- Find patterns in filenames

```{r}
years <- 2010:2015
files <- paste0("http://aqsdr1.epa.gov/aqsweb/aqstmp/airdata/annual_all_", years, ".zip")
files
```

## URL's

- Create a small utility function

```{r}
download_epa_aqs <- function(years) {
  files <- paste0("http://aqsdr1.epa.gov/aqsweb/aqstmp/airdata/annual_all_", years, ".zip")
  for (i in seq(years)) {
    tmp <- tempfile()
    download.file(files[i], tmp)
    unzip(tmp, paste0("annual_all_", years[i], ".csv"))
  }
}
```

```{r eval = FALSE}
download_epa_aqs(2000:2002)
```

## Scraping

http://energyalmanac.ca.gov/electricity/web_qfer/Heat_Rates.php

<iframe src="http://energyalmanac.ca.gov/electricity/web_qfer/Heat_Rates.php"></iframe>

## Scraping

```{r}
library(XML)
f <- "http://energyalmanac.ca.gov/electricity/web_qfer/Heat_Rates.php"
d <- readHTMLTable(f, which = 1)
head(d)
```

## Scraping

<iframe src="https://en.wikipedia.org/wiki/List_of_highest-grossing_films"></iframe>

## Scraping

```{r warning=FALSE}
library(rvest)
d <- read_html("https://en.wikipedia.org/wiki/List_of_highest-grossing_films") %>%
  html_node(".wikitable") %>% 
  html_table()
```

## Scraping

```{r warning=FALSE}
head(d)
```

## Scraping

<div align="center">
<img src="04_illustration/dolce_vita.png" alt="La Dolce Vita" style="height: 400px;"/>
</div>

http://www.imdb.com/title/tt0053779/

## Scraping

```{r}
read_html("http://www.imdb.com/title/tt0053779/") %>%
  html_nodes("#titleCast .itemprop span") %>%
  html_text()
```

## Scraping

```{python eval=FALSE}
import imdb
access = imdb.IMDb()
movie = access.get_movie(53779)
print movie # La dolce vita
```

http://www.crummy.com/software/BeautifulSoup/

<iframe src="http://www.crummy.com/software/BeautifulSoup/"></iframe>

## API's (more in March 2016)

- Application Programming Interface

- Example: census data.  Key required: http://api.census.gov/data/key_signup.html

- http://rstudio-pubs-static.s3.amazonaws.com/19337_2e7f827190514c569ea136db788ce850.html

# Spatial data

## Coordinate systems

```{r warning=FALSE}
d <- fread("annual_all_2015.csv")
names(d)
```

## Coordinate systems

```{r}
library(sp)
spD <- copy(d[! `State Name` %in% c("Hawaii", "Puerto Rico", "Alaska")])
coordinates(spD) <- ~ Longitude + Latitude
```

## Coordinate systems

```{r}
plot(spD)
```

## File formats

## GDAL

## OGR

## KML

## R packages

# R API clients

## ArcGIS

## QGIS

## Google Maps

# Databases

## PostgreSQL and PostGIS

## sqlite and spatialite

# Visualization

## ggplot2 and ggmap

## leaflet (and grammars again!)

```{r}
library(ggmap)
```

## Interactivity: graphics

- `ggvis`

- `GoogleVis`

## Interactivity: servers

## Shiny 101

## Deployment
