---
pagetitle: P01 - Data linkage
---

# Merging

## Base R

```{r}
authors <- data.frame(
  surname = I(c("Tukey", "Venables", "Tierney", "Ripley", "McNeil")),
  nationality = c("US", "Australia", "US", "UK", "Australia"),
  deceased = c("yes", rep("no", 4)))
books <- data.frame(
  name = I(c("Tukey", "Venables", "Tierney",
             "Ripley", "Ripley", "McNeil", "R Core")),
  title = c("Exploratory Data Analysis",
            "Modern Applied Statistics ...",
            "LISP-STAT",
            "Spatial Statistics", "Stochastic Simulation",
            "Interactive Data Analysis",
            "An Introduction to R"),
  other.author = c(NA, "Ripley", NA, NA, NA, NA,
                   "Venables & Smith"))
```

```{r}
authors
```

```{r}
books
```

```{r}
merge(authors, books, by.x = "surname", by.y = "name")
```

```{r}
merge(books, authors, by.x = "name", by.y = "surname")
```

```{r}
merge(authors, books, by.x = "surname", by.y = "name", all = TRUE)
merge(authors, books, by.x = "surname", by.y = "name", all.x = TRUE)
merge(authors, books, by.x = "surname", by.y = "name", all.y = TRUE)
```

## `dplyr`

```{r}
library(dplyr)
dp_authors <- tbl_df(authors)
dp_books <- tbl_df((books))
inner_join(dp_books, dp_authors, by = c("name" = "surname"))
```

```{r}
right_join(dp_books, dp_authors, by = c("name" = "surname"))
```

```{r}
left_join(dp_books, dp_authors, by = c("name" = "surname"))
```

## `data.table`

- Same as base, but *faster*
- Keys can be used

```{r}
library(data.table)
dt_authors <- data.table(authors)
dt_books <- data.table((books))
setkey(dt_authors, surname)
setkey(dt_books, name)
```

```{r}
dt_authors[dt_books]
dt_books[dt_authors]
```

# Working with databases

## RDBMS

- Relational database management system
- IBM, early 1970's

## SQL

- Structured Query Language

<iframe src = "https://en.wikipedia.org/wiki/SQL#Operators" width = "100%" height = "400px";"></iframe>

```{r}
library(rvest)
html("https://en.wikipedia.org/wiki/SQL") %>%
  html_node(".wikitable") %>% 
  html_table()
```

## sqlite

## PostGresql

## NoDB

# Working with geospatial data

## `sp` package

## PostGIS

# Cloud-computing

- AWS

# Lab session

-   Select and implement the most efficient method to merge datasets of different scales
