<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />



<title>P01 - Zelig</title>

<script src="libs/jquery/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="libs/bootstrap/css/bootstrap.min.css" rel="stylesheet" />
<script src="libs/bootstrap/js/bootstrap.min.js"></script>
<script src="libs/bootstrap/shim/html5shiv.min.js"></script>
<script src="libs/bootstrap/shim/respond.min.js"></script>

<style type="text/css">code{white-space: pre;}</style>
<link rel="stylesheet"
      href="libs/highlight/default.css"
      type="text/css" />
<script src="libs/highlight/highlight.js"></script>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs && document.readyState && document.readyState === "complete") {
   window.setTimeout(function() {
      hljs.initHighlighting();
   }, 0);
}
</script>



</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img { 
  max-width:100%; 
  height: auto; 
}
</style>
<div class="container-fluid main-container">

<style type="text/css">
  body {
    padding-top: 20px;
  }
  .navbar-brand {
    font-weight: bold;
  }
  footer {
    border-top: 1px solid #CCC;
    margin-top: 60px;
    margin-bottom: 48px;
    opacity: 0.75;
  }
  .content-body>:first-child, .content-body>:first-child>:first-child {
    margin-top: 0 !important;
  }
  p code {
    white-space: inherit;
  }
</style>

<div class="fluid-row">
  <div class="col-sm-12">
    <nav class="navbar navbar-inverse">
      <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header">
          <a class="navbar-brand" href="./">P01 - Advanced R</a>
        </div>
      </div>
    </nav>
  </div>
</div>

<div class="fluid-row">
  <div class="col-sm-3">
    <div class="list-group">
      <a class="list-group-item" href="./">Introduction</a>
      <a class="list-group-item" href="refresheR.html">refreshR</a>
      <a class="list-group-item" href="creating_packages.html">Creating R packages</a>
      <a class="list-group-item" href="data_linkage.html">Data linkage</a>
      <a class="list-group-item" href="data_visualization.html">Data visualization</a>
      <a class="list-group-item" href="data_wrangling.html">Data wrangling</a>
      <a class="list-group-item" href="statistical_programming.html">Statistical programming</a>
      <a class="list-group-item" href="zelig.html">Zelig</a>
    </div>
    <script>
      // manage active state of toc based on current page
      var href = window.location.pathname;
      href = href.substr(href.lastIndexOf('/') + 1);
      if (href === "" || href === "index.html")
        href = "./";
      $('a.list-group-item[href="' + href + '"]').addClass('active');
    </script>
  </div>
  <div class="col-sm-9 content-body">


<div id="TOC">
<ul>
<li><a href="#workflow">Workflow</a></li>
<li><a href="#oo-programming">OO programming</a><ul>
<li><a href="#object-oriented-paradigm">Object-oriented paradigm</a></li>
<li><a href="#a-brief-history-of-oo-in-r-from-s3-to-r6">A brief history of OO in R, from S3 to R6</a></li>
<li><a href="#s3-classes">S3 classes</a><ul>
<li><a href="#object-class">Object class</a></li>
</ul></li>
<li><a href="#function-methods">Function methods</a></li>
<li><a href="#creating-new-function-methods">Creating new function methods</a></li>
<li><a href="#creating-generic-functions">Creating generic functions</a></li>
<li><a href="#s4-classes">S4 classes</a></li>
</ul></li>
<li><a href="#oo-in-zelig">OO in Zelig</a></li>
<li><a href="#lab-session">Lab session</a></li>
</ul>
</div>

<div id="workflow" class="section level1">
<h1>Workflow</h1>
<ul>
<li>Amelia: multiple imputation of missing values</li>
<li>MatchIt / CEM (Coarsened Exact Matching): matching</li>
<li>Zelig: estimation, simulation, plots</li>
<li>WhatIf: counterfactuals</li>
</ul>
</div>
<div id="oo-programming" class="section level1">
<h1>OO programming</h1>
<div id="object-oriented-paradigm" class="section level2">
<h2>Object-oriented paradigm</h2>
</div>
<div id="a-brief-history-of-oo-in-r-from-s3-to-r6" class="section level2">
<h2>A brief history of OO in R, from S3 to R6</h2>
<p>R has two major object systems:</p>
<ul>
<li>Relatively informal “S3” classes</li>
<li>Stricter, more formal “S4” classes</li>
<li>We will cover only the S3 system, not the S4 system</li>
<li>Basic idea: functions have different methods for different types of objects</li>
</ul>
</div>
<div id="s3-classes" class="section level2">
<h2>S3 classes</h2>
<div id="object-class" class="section level3">
<h3>Object class</h3>
<pre class="r"><code>x &lt;- 1:10
class(x) </code></pre>
<pre><code>## [1] &quot;integer&quot;</code></pre>
<pre class="r"><code>class(x) &lt;- &quot;foo&quot;
class(x)</code></pre>
<pre><code>## [1] &quot;foo&quot;</code></pre>
<p>Objects are not limited to a single class, and can have many classes:</p>
<pre class="r"><code>class(x) &lt;- c(&quot;A&quot;, &quot;B&quot;)
class(x)</code></pre>
<pre><code>## [1] &quot;A&quot; &quot;B&quot;</code></pre>
</div>
</div>
<div id="function-methods" class="section level2">
<h2>Function methods</h2>
<ul>
<li>Functions can have many methods, allowing us to have (e.g.) one plot() function that does different things depending on what is being plotted()</li>
<li>Methods can only be defined for generic functions: `plot`, `print`, `summary`, `mean`, and several others are already generic</li>
</ul>
<pre class="r"><code># see what methods have been defined for the mean function
methods(mean)</code></pre>
<pre><code>## [1] mean.Date     mean.default  mean.difftime mean.POSIXct  mean.POSIXlt 
## see &#39;?methods&#39; for accessing help and source code</code></pre>
<pre class="r"><code># which functions have methods for data.frames?
methods(class=&quot;data.frame&quot;)[1:9]</code></pre>
<pre><code>## [1] &quot;[.data.frame&quot;             &quot;[[.data.frame&quot;           
## [3] &quot;[[&lt;-.data.frame&quot;          &quot;[&lt;-.data.frame&quot;          
## [5] &quot;$.data.frame&quot;             &quot;$&lt;-.data.frame&quot;          
## [7] &quot;aggregate.data.frame&quot;     &quot;anyDuplicated.data.frame&quot;
## [9] &quot;as.data.frame.data.frame&quot;</code></pre>
</div>
<div id="creating-new-function-methods" class="section level2">
<h2>Creating new function methods</h2>
<p>To create a new method for a function that is already generic all you have to do is name your function `function.class`</p>
<pre class="r"><code># create a mean() method for objects of class &quot;foo&quot;:
mean.foo &lt;- function(x) { # mean method for &quot;foo&quot; class
  if(is.numeric(x)) {
    cat(&quot;The average is&quot;, mean.default(x))
    return(invisible(mean.default(x))) #use mean.default for numeric
    } else
      cat(&quot;x is not numeric \n&quot;)} # otherwise say x not numeric

x &lt;- 1:10
mean(x)</code></pre>
<pre><code>## [1] 5.5</code></pre>
<pre class="r"><code>class(x) &lt;- &quot;foo&quot;
mean(x)</code></pre>
<pre><code>## The average is 5.5</code></pre>
<pre class="r"><code>x &lt;- as.character(x)
class(x) &lt;- &quot;foo&quot;
mean(x)</code></pre>
<pre><code>## x is not numeric</code></pre>
</div>
<div id="creating-generic-functions" class="section level2">
<h2>Creating generic functions</h2>
<p>S3 generics are most often used for print, summary, and plot methods, but sometimes you may want to create a new generic function</p>
<pre class="r"><code># create a generic disp() function
disp &lt;- function(x, ...) {
  UseMethod(&quot;disp&quot;)
  }

# create a disp method for class &quot;matrix&quot;
disp.matrix &lt;- function(x) {
  print(round(x, digits=2))
  }

# test it out
disp(matrix(runif(10), ncol=2))</code></pre>
<pre><code>##      [,1] [,2]
## [1,] 0.57 0.42
## [2,] 0.49 0.98
## [3,] 0.78 0.33
## [4,] 0.54 0.89
## [5,] 0.09 0.42</code></pre>
</div>
<div id="s4-classes" class="section level2">
<h2>S4 classes</h2>
<p><a href="https://google-styleguide.googlecode.com/svn/trunk/Rguide.xml" class="uri">https://google-styleguide.googlecode.com/svn/trunk/Rguide.xml</a>:</p>
<blockquote>
<p>The S language has two object systems, S3 and S4, both of which are available in R. S3 methods are more interactive and flexible, whereas S4 methods are more formal and rigorous. (For an illustration of the two systems, see Thomas Lumley’s “Programmer’s Niche: A Simple Class, in S3 and S4” in R News 4/1, 2004, pgs. 33 - 36: <a href="http://cran.r-project.org/doc/Rnews/Rnews_2004-1.pdf" class="uri">http://cran.r-project.org/doc/Rnews/Rnews_2004-1.pdf</a>.)</p>
<p>Use S3 objects and methods unless there is a strong reason to use S4 objects or methods. A primary justification for an S4 object would be to use objects directly in C++ code. A primary justification for an S4 generic/method would be to dispatch on two arguments.</p>
<p>Avoid mixing S3 and S4: S4 methods ignore S3 inheritance and vice-versa.</p>
</blockquote>
</div>
</div>
<div id="oo-in-zelig" class="section level1">
<h1>OO in Zelig</h1>
<p>Models as reference classes</p>
</div>
<div id="lab-session" class="section level1">
<h1>Lab session</h1>
<ul>
<li>Create a Zelig model</li>
</ul>
</div>

<footer>
<p><small>Christine Choirat<br/>
P01 - Advanced R<br/>
Harvard T.H Chan School of Public Health <a>http://www.hsph.harvard.edu/</a>
</small></p>
</footer>

  </div>
</div>

<a href="https://github.com/p01r/p01r"><img style="position: absolute; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/38ef81f8aca64bb9a64448d0d70f1308ef5341ab/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"></a>

</div>

<script>

// add bootstrap table styles to pandoc tables
$(document).ready(function () {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
});

</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
