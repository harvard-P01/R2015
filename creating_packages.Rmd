---
pagetitle: P01 - Creating packages
---

# Contributed packages

<iframe src = "https://cran.r-project.org/web/packages/" width = "100%" height = "800px";"></iframe>

# Packages

- For an audience:
    - public good
    - grants
    - publication supplemental material

- For you (and your future self):
    - better coding practise
    - better workflow
    - better teamwork

- Main reference: @wickham2015rpackages

# Package structure

- `DESCRIPTION` and `NAMESPACE`
- Code `R/`
- Documentation `doc/`
- Vignettes `vignettes/` (PDF or HTLM, link on CRAN package page)
- Data `data/`
- Compiled code `scr/`
- Installed files `inst/`
- Unit test `tests` (with `testhat` package)
- Demos `demo/` (not tested by R CMD check)
- Executable scripts `exec/`
- Translations `po/`

# Workflow

## devtools

- `load_all()`: simulates installing and reloading
- `build()`: builds package file from source
- `install()`: (re)installs package
- `document()`: updates documentation
- `check()`: documentation, build, check
- `test()`: reloads and runs `testthat` tests

## ROxygen2

- `.Rd` format

From ROxygen2 [vignette](https://cran.r-project.org/web/packages/roxygen2/vignettes/rd.html)

1. As a separate file

```{r eval=FALSE}
% Generated by roxygen2 (3.2.0): do not edit by hand
\name{add}
\alias{add}
\title{Add together two numbers}
\usage{
add(x, y)
}
\arguments{
  \item{x}{A number}

  \item{y}{A number}
}
\value{
The sum of \code{x} and \code{y}
}
\description{
Add together two numbers
}
\examples{
add(1, 1)
add(10, 1)
}
```

2. As code decoration

```{r eval=FALSE}
#' Add together two numbers
#'
#' @param x A number
#' @param y A number
#' @return The sum of \code{x} and \code{y}
#' @examples
#' add(1, 1)
#' add(10, 1)
add <- function(x, y) {
  x + y
}
```

## Documenting functions

- `@param name1, name2, name3 description`
- `@examples` (code run with `R CMD check`)
    - `\dontrun{}`
    - `\dontshow{}`
    - `\donttest{}`
- `@return description`

## Documenting datasets

- `@format`
- `@source`

## Documenting packages

- `@docType package` or `@name roxygen2-package`

## Some keywords

- `@section`, `\subsection{}`
- `@references`
- `\url{}`

# Package skeleton

```{r}
f <- function(x) {
  return(x^2)
}

g <- function(x, y) {
  return(x^2 + y^2)
}

d <- data.frame(a = 1:10, b = 13:22)

# package.skeleton(name = "p01r", list = c("f", "g", "d"))
```

## GitHub

```{r eval=FALSE}
install.packages("devtools")
devtools::install_github("username/packagename")
```

Example: https://github.com/IQSS/Amelia

# From GitHub to CRAN

# Lab session

# References
